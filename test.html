<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>نموذج الطلب</title>

<style>
  body { font-family: sans-serif; background: #f0f0f0; padding: 20px; }
  form { max-width: 480px; margin: auto; background: #fff; padding: 25px; border-radius: 12px; }
  label { font-weight: bold; margin-bottom: 6px; display:block; }
  input, select { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #ccc; margin-bottom: 15px; }
  button { width: 100%; padding: 12px; background: #28a745; border: none; color:#fff; border-radius: 8px; cursor:pointer; font-size:16px; }
  button:hover { background:#218838; }
  #success { display:none; color:green; text-align:center; margin-top:10px; }
</style>
</head>

<body>

<h2 style="text-align:center">نموذج الطلب</h2>

<form id="orderForm">

  <label>الاسم الكامل</label>
  <input type="text" id="name" required>

  <label>رقم الهاتف</label>
  <input type="text" id="phone" required>

  <label>الولاية</label>
  <select id="wilaya" required></select>

  <label>البلدية</label>
  <select id="commune" required></select>

  <label>عدد الوحدات</label>
  <input type="number" id="qty" min="1" value="1" required>

  <button type="submit">إرسال الطلب</button>

  <p id="success">✔ تم إرسال الطلب بنجاح</p>
</form>


<script>
const API_URL = "PASTE_YOUR_GOOGLE_SCRIPT_URL_HERE";

// تحميل ملف dz-2025.json
let data = {};
fetch("dz-2025.json")
  .then(res => res.json())
  .then(json => {
    data = json;
    populateWilayas();
  });

// عرض الولايات
function populateWilayas() {
  const w = document.getElementById("wilaya");
  Object.keys(data).forEach(wilaya => {
    let opt = document.createElement("option");
    opt.value = wilaya;
    opt.textContent = wilaya;
    w.appendChild(opt);
  });

  loadCommunes();
}

// عرض البلديات حسب الولاية
document.getElementById("wilaya").onchange = loadCommunes;

function loadCommunes() {
  const w = document.getElementById("wilaya").value;
  const c = document.getElementById("commune");
  c.innerHTML = "";

  data[w].forEach(commune => {
    let opt = document.createElement("option");
    opt.value = commune;
    opt.textContent = commune;
    c.appendChild(opt);
  });
}

// إرسال الطلب
document.getElementById("orderForm").onsubmit = async e => {
  e.preventDefault();

  const payload = {
    name: document.getElementById("name").value,
    phone: document.getElementById("phone").value,
    wilaya: document.getElementById("wilaya").value,
    commune: document.getElementById("commune").value,
    qty: document.getElementById("qty").value
  };

  await fetch(API_URL, {
    method: "POST",
    body: JSON.stringify(payload)
  });

  document.getElementById("success").style.display = "block";
  document.getElementById("orderForm").reset();
};
</script>

</body>
</html>
